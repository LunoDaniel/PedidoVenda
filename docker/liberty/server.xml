<?xml version="1.0" encoding="UTF-8"?>
<server description="PedidoVenda Liberty server">

    <!-- Enable the following features -->
    <featureManager>
        <feature>jakartaee-10.0</feature>
        <feature>microProfile-6.0</feature>
    </featureManager>

    <!-- This template enables security. To get the full use of all the capabilities, a keystore and user registry are required. -->
    
    <!-- For the keystore, default keys are generated and stored in a keystore. To provide the keystore password, generate an 
         encoded password using bin/securityUtility encode and add it below in the password attribute of the keyStore element. 
         Then uncomment the keyStore element. -->
    <!--
    <keyStore id="defaultKeyStore" password="<encoded password>"/>
    -->
    
    <!-- To access this server from a remote client add a host attribute to the following element, e.g. host="*" -->
    <httpEndpoint id="defaultHttpEndpoint"
                  httpPort="9080"
                  httpsPort="9443" />
                  
    <!-- Automatically expand WAR files and EAR files -->
    <applicationManager autoExpand="true"/>
    
    <!-- MySQL DataSource Configuration -->
    <library id="mysql-lib">
        <fileset dir="${shared.resource.dir}/mysql" includes="*.jar"/>
    </library>

    <dataSource id="PedidoVendaDS" jndiName="jdbc/PedidoVendaDS">
        <jdbcDriver libraryRef="mysql-lib"/>
        <properties databaseName="pedidovenda"
                    serverName="pedidovenda-mysql"
                    portNumber="3306"
                    user="app_user"
                    password="app_password"/>
    </dataSource>

    <!-- Default SSL configuration enables trust for default certificates from the Java runtime -->
    <ssl id="defaultSSLConfig" trustDefaultCerts="true" />
    
    <!-- User Registry -->
    <basicRegistry id="basic" realm="BasicRegistry">
        <user name="admin" password="admin123"/>
        <user name="user" password="user123"/>
        <group name="ADMIN">
            <member name="admin"/>
        </group>
        <group name="USER">
            <member name="user"/>
            <member name="admin"/>
        </group>
    </basicRegistry>


    <!-- Automatically expand WAR files and EAR files -->
    <applicationManager autoExpand="true"/>

    <!-- MySQL DataSource Configuration -->
    <!-- ... (dataSource e library mysql-lib permanecem os mesmos) ... -->

    <!-- ********** NOVO: Configuração do ClassLoader para sua aplicação ********** -->
    <application name="PedidoVenda" location="PedidoVenda.war" type="war">
        <classloader delegation="parentLast"/>
    </application>
    <!-- ************************************************************************* -->

</server>
